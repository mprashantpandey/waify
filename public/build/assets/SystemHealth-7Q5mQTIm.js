import{j as e}from"./react-B_HteL0F.js";import{u,H as v,i as r,g as l,A as w,at as C,aB as S,T as D}from"./vendor-GYTC5Pip.js";import{P as B}from"./PlatformShell-D3A5CZuP.js";import{C as d,a as i,b as x,d as y,c}from"./Card-CUbeq4wI.js";import{B as n}from"./Topbar-CPirX8py.js";import"./BrandingWrapper-DIBfDp2T.js";import"./GlobalFlashHandler-DpywDQft.js";import"./useToast-Rch7lQVh.js";import"./app-C0WBMkkY.js";/* empty css            */function L({webhook_health:m,connection_details:p,queue_status:t,storage_status:h,database_status:a,recent_errors:j}){const{auth:N}=u().props,f=s=>{if(s===null||s===0)return"0 B";const g=1024,k=["B","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(g));return Math.round(s/Math.pow(g,o)*100)/100+" "+k[o]},b=s=>s?e.jsxs(n,{variant:"success",className:"flex items-center gap-1",children:[e.jsx(r,{className:"h-3 w-3"}),"Healthy"]}):e.jsxs(n,{variant:"danger",className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-3 w-3"}),"Unhealthy"]});return e.jsxs(B,{auth:N,children:[e.jsx(v,{title:"System Health"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"System Health"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Monitor system components and infrastructure status"})]}),e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsx(x,{children:"Webhook Health"}),e.jsx(y,{children:"WhatsApp webhook subscription and activity status"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Total Connections"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:m.total})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Subscribed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:m.subscribed})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Recent Activity (24h)"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:m.recent_activity})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"With Errors"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:m.with_errors})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Connection Details"}),e.jsx("div",{className:"space-y-2",children:p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.is_healthy?e.jsx(r,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(l,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Workspace ID: ",s.workspace_id]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.last_received_at&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Last Activity"}),e.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:new Date(s.last_received_at).toLocaleString()})]}),b(s.is_healthy)]})]},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Queue Status"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Driver"}),e.jsx(n,{variant:"info",children:t.driver})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connection"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.connection||"N/A"})]}),t.pending_jobs!==null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending Jobs"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.pending_jobs})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Failed Jobs"}),e.jsx(n,{variant:t.failed_jobs&&t.failed_jobs>0?"danger":"success",children:t.failed_jobs??"N/A"})]})]})]}),e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Storage Status"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Public Available"}),h.public_available?e.jsx(r,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(l,{className:"h-5 w-5 text-red-600 dark:text-red-400"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Public Writable"}),h.public_writable?e.jsx(r,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(l,{className:"h-5 w-5 text-red-600 dark:text-red-400"})]}),h.public_size!==null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Public Size"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:f(h.public_size)})]})]})]}),e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Database Status"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connection"}),a.connected?e.jsx(r,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(l,{className:"h-5 w-5 text-red-600 dark:text-red-400"})]}),a.connected&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Driver"}),e.jsx(n,{variant:"info",children:a.driver})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Database"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.connection})]})]}),a.error&&e.jsx("div",{className:"p-2 bg-red-50 dark:bg-red-900/20 rounded text-xs text-red-600 dark:text-red-400",children:a.error})]})]})]}),j.length>0&&e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}),"Recent Errors"]}),e.jsx(y,{children:"Failed jobs and system errors"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:j.map(s=>e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.payload?.displayName||s.payload?.job||"Unknown Job"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Queue: ",s.queue," | Connection: ",s.connection]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(s.failed_at).toLocaleString()})]}),e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-red-600 dark:text-red-400 cursor-pointer hover:underline",children:"View Error Details"}),e.jsx("pre",{className:"mt-2 text-xs bg-gray-900 text-gray-100 p-2 rounded overflow-auto max-h-40",children:s.exception})]})]},s.id))})})]})]})]})}export{L as default};
