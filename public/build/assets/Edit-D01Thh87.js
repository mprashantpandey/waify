import{j as e}from"./react-BhzSerM2.js";import{G as _,H as S,l as p,N as E,a0 as F,X as q}from"./vendor-DxGhd0kb.js";import{A}from"./AppShell-Cc2RD8Vl.js";import{C as x,b as h,c as g,d as v,a as j}from"./Card-W2rT1n1C.js";import{B as o}from"./app-Iwsu59co.js";import{T as b}from"./TextInput-DRXLElIV.js";import{I as n}from"./InputLabel-qVeuR0hO.js";import{I}from"./InputError-6mWSc7R2.js";import{u as T}from"./useToast-m6H8bvjE.js";import"./Topbar-DdwsMJGZ.js";import"./Badge-i1wYvjg_.js";import"./GlobalFlashHandler-xHP6pVTU.js";import"./BrandingWrapper-DK418oSm.js";import"./Alert-CNardO3g.js";import"./CookieConsentBanner-CkGeiZeY.js";/* empty css            */const D=[{value:"equals",label:"equals"},{value:"not_equals",label:"not equals"},{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"},{value:"starts_with",label:"starts with"},{value:"ends_with",label:"ends with"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}];function Y({account:B,segment:t,filter_fields:m}){const{toast:u}=T(),{data:l,setData:i,put:f,processing:y,errors:w}=_({name:t.name,description:t.description||"",filters:t.filters.length?t.filters.map(a=>({field:a.field,operator:a.operator,value:a.value??""})):[]}),N=()=>{i("filters",[...l.filters,{field:m[0]?.value??"name",operator:"equals",value:""}])},k=a=>{i("filters",l.filters.filter((r,s)=>s!==a))},d=(a,r,s)=>{const c=[...l.filters];c[a]={...c[a],[r]:s},i("filters",c)},C=a=>{a.preventDefault(),f(route("app.contacts.segments.update",{segment:t.id}),{onSuccess:()=>u.success("Segment updated"),onError:()=>u.error("Failed to update segment")})};return e.jsxs(A,{children:[e.jsx(S,{title:`Edit ${t.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(p,{href:route("app.contacts.segments.show",{segment:t.id}),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 mb-4",children:[e.jsx(E,{className:"h-4 w-4"}),"Back to Segment"]}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent",children:"Edit segment"})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"Segment details"}),e.jsx(v,{children:"Name and optional description"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{value:"Name *"}),e.jsx(b,{value:l.name,onChange:a=>i("name",a.target.value),className:"mt-1 w-full max-w-md",required:!0}),e.jsx(I,{message:w.name})]}),e.jsxs("div",{children:[e.jsx(n,{value:"Description (optional)"}),e.jsx("textarea",{value:l.description,onChange:a=>i("description",a.target.value),className:"mt-1 w-full max-w-md rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800 px-3 py-2",rows:2})]})]})]}),e.jsxs(x,{className:"mt-6",children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Filters"}),e.jsx(v,{children:"Contacts that match all rules below will be in this segment"})]}),e.jsxs(o,{type:"button",variant:"secondary",size:"sm",onClick:N,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add rule"]})]})}),e.jsx(j,{className:"space-y-4",children:l.filters.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No filters. Add a rule to limit which contacts are in this segment."}):l.filters.map((a,r)=>e.jsxs("div",{className:"flex flex-wrap items-end gap-2 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{className:"w-40",children:[e.jsx(n,{value:"Field"}),e.jsx("select",{value:a.field,onChange:s=>d(r,"field",s.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800",children:m.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"w-36",children:[e.jsx(n,{value:"Operator"}),e.jsx("select",{value:a.operator,onChange:s=>d(r,"operator",s.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800",children:D.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),a.operator!=="is_empty"&&a.operator!=="is_not_empty"&&e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx(n,{value:"Value"}),e.jsx(b,{value:a.value,onChange:s=>d(r,"value",s.target.value),className:"mt-1"})]}),e.jsx(o,{type:"button",variant:"secondary",size:"sm",onClick:()=>k(r),children:e.jsx(q,{className:"h-4 w-4"})})]},r))})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx(o,{type:"submit",disabled:y,children:"Save changes"}),e.jsx(p,{href:route("app.contacts.segments.show",{segment:t.id}),children:e.jsx(o,{type:"button",variant:"secondary",children:"Cancel"})})]})]})]})]})}export{Y as default};
