import{r as d,j as e}from"./react-BhzSerM2.js";import{H as c,A as l,C as x,l as H,N as S,av as A,a as L,T as $,p as B,aT as T,Z as R,D as O,f as D,L as E}from"./vendor-DxGhd0kb.js";import{A as m}from"./AppShell-CkAdHkwF.js";import{C as u,b as I,c as F,d as M,a as j}from"./Card-2LWG2Pxg.js";import{B as P}from"./Badge-DpSbAfCU.js";import{B as U}from"./app-LxBsIpMW.js";import{u as Z}from"./useToast-m6H8bvjE.js";import{A as b}from"./Alert-u745Uvig.js";import"./Topbar-C479R05n.js";import"./GlobalFlashHandler-xHP6pVTU.js";import"./BrandingWrapper-DK418oSm.js";import"./CookieConsentBanner-RgCHAFaX.js";/* empty css            */function se({account:z,connection:t}){const{toast:k}=Z(),[s,w]=d.useState(null),[N,h]=d.useState(!0),[o,g]=d.useState(!1),y=async(a=!1)=>{a?g(!0):h(!0);try{const r=await L.get(route("app.whatsapp.connections.health.api",{connection:t.slug??t.id}));w(r.data)}catch(r){k.error("Failed to fetch health check data"),console.error("Health check error:",r)}finally{h(!1),g(!1)}};d.useEffect(()=>{y()},[t.slug,t.id]);const p=a=>{const r={healthy:"success",warning:"warning",unhealthy:"danger",unknown:"default"};return e.jsx(P,{variant:r[a]||"default",className:"px-3 py-1",children:a.charAt(0).toUpperCase()+a.slice(1)})},v=a=>{switch(a){case"healthy":return e.jsx(B,{className:"h-5 w-5 text-green-600 dark:text-green-400"});case"warning":return e.jsx($,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"});case"unhealthy":return e.jsx(x,{className:"h-5 w-5 text-red-600 dark:text-red-400"});default:return e.jsx(l,{className:"h-5 w-5 text-gray-400"})}},C=a=>{const n={connection_active:l,webhook_subscription:E,webhook_activity:D,access_token:O,api_connectivity:R,phone_number:T}[a]||l;return e.jsx(n,{className:"h-4 w-4"})};if(N)return e.jsxs(m,{children:[e.jsx(c,{title:`${t.name} - Health Check`}),e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(l,{className:"h-12 w-12 text-gray-400 animate-pulse mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading health check..."})]})})]});if(!s)return e.jsxs(m,{children:[e.jsx(c,{title:`${t.name} - Health Check`}),e.jsx("div",{className:"space-y-8",children:e.jsxs(b,{variant:"error",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Failed to load health check"}),e.jsx("p",{className:"text-sm mt-1",children:"Please try again or contact support."})]})]})})]});const _={healthy:"from-green-500 to-green-600",warning:"from-yellow-500 to-yellow-600",unhealthy:"from-red-500 to-red-600",unknown:"from-gray-500 to-gray-600"}[s.overall_status]||"from-gray-500 to-gray-600";return e.jsxs(m,{children:[e.jsx(c,{title:`${t.name} - Health Check`}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(H,{href:route("app.whatsapp.connections.edit",{connection:t.slug??t.id}),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors mb-4",children:[e.jsx(S,{className:"h-4 w-4"}),"Back to Connection"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent flex items-center gap-3",children:[e.jsx(l,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}),"Health Check"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:t.name})]})]}),e.jsxs(U,{onClick:()=>y(!0),disabled:o,variant:"secondary",className:"rounded-xl",children:[e.jsx(A,{className:`h-4 w-4 mr-2 ${o?"animate-spin":""}`}),o?"Refreshing...":"Refresh"]})]}),e.jsxs(u,{className:"border-0 shadow-lg",children:[e.jsx(I,{className:`bg-gradient-to-r ${_} text-white`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:v(s.overall_status)}),e.jsxs("div",{children:[e.jsx(F,{className:"text-xl font-bold text-white",children:"Overall Status"}),e.jsxs(M,{className:"text-white/90",children:["Last checked: ",new Date(s.timestamp).toLocaleString()]})]})]}),p(s.overall_status)]})}),e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:s.summary.healthy}),e.jsx("div",{className:"text-xs font-semibold text-green-600 dark:text-green-400 uppercase tracking-wider mt-1",children:"Healthy"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 rounded-xl border border-yellow-200 dark:border-yellow-800",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:s.summary.warnings}),e.jsx("div",{className:"text-xs font-semibold text-yellow-600 dark:text-yellow-400 uppercase tracking-wider mt-1",children:"Warnings"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 rounded-xl border border-red-200 dark:border-red-800",children:[e.jsx("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:s.summary.unhealthy}),e.jsx("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400 uppercase tracking-wider mt-1",children:"Unhealthy"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-700 dark:text-gray-300",children:s.summary.total_checks}),e.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider mt-1",children:"Total Checks"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.checks).map(([a,r])=>{const n={healthy:"from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-green-200 dark:border-green-800",warning:"from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 border-yellow-200 dark:border-yellow-800",unhealthy:"from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 border-red-200 dark:border-red-800",unknown:"from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border-gray-200 dark:border-gray-700"}[r.status]||"from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border-gray-200 dark:border-gray-700";return e.jsx(u,{className:`border-0 shadow-lg ${n.split(" ")[0]} border-2`,children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${r.status==="healthy"?"bg-green-500":r.status==="warning"?"bg-yellow-500":r.status==="unhealthy"?"bg-red-500":"bg-gray-500"}`,children:C(a)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 capitalize",children:a.replace(/_/g," ")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-0.5",children:r.message})]})]}),p(r.status)]}),r.error&&e.jsxs(b,{variant:"error",className:"mb-4",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:r.error})]}),r.details&&Object.keys(r.details).length>0&&e.jsx("div",{className:"mt-4 p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(r.details).map(([f,i])=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:f.replace(/_/g," ")}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:i===null||i===""?"â€”":String(i)})]},f))})})]})},a)})})]})]})}export{se as default};
