import{j as e,r}from"./react-BhzSerM2.js";import{u as it,H as lt,G as Gt,a as S,e as Jt,l as Se,N as Qt,aT as Zt,b1 as Xt,b0 as Yt,X as se,as as ea,k as ot,b2 as ta,b3 as aa,b4 as sa,aW as dt,F as ct,b5 as ra,b6 as na,Z as ia,a0 as la,f as oa,b7 as xt,$ as da}from"./vendor-DxGhd0kb.js";import{A as mt}from"./AppShell-hblPOeic.js";import{a as ca,c as K,B as u}from"./app-CHptu5EX.js";import{T as h}from"./TextInput-DRXLElIV.js";import{T as gt}from"./Textarea-WuXup_o6.js";import{B as ut}from"./Badge-DOejrt-x.js";import{M as xa}from"./Skeleton-CfTHwkjJ.js";import{u as ma}from"./useToast-m6H8bvjE.js";import"./Topbar-DAizFNof.js";import"./GlobalFlashHandler-xHP6pVTU.js";import"./BrandingWrapper-DK418oSm.js";import"./Alert-B2z6wKx8.js";import"./CookieConsentBanner-BIdbL3YD.js";/* empty css            */function La({account:p,conversation:Ae,messages:Le=[],templates:Te=[],lists:Me=[],notes:De=[],audit_events:Ee=[],agents:Be=[],inbox_settings:Ie={auto_assign_enabled:!1,auto_assign_strategy:"round_robin"}}){const g=it().props,I=Ae??g?.conversation??null,ht=Array.isArray(Le)?Le:Array.isArray(g?.messages)?g.messages:[],pt=Array.isArray(De)?De:Array.isArray(g?.notes)?g.notes:[],bt=Array.isArray(Ee)?Ee:Array.isArray(g?.audit_events)?g.audit_events:[],yt=Array.isArray(Be)?Be:Array.isArray(g?.agents)?g.agents:[],ft=Array.isArray(Te)?Te:Array.isArray(g?.templates)?g.templates:[],vt=Array.isArray(Me)?Me:Array.isArray(g?.lists)?g.lists:[];if(!I)return e.jsxs(mt,{children:[e.jsx(lt,{title:"Conversation"}),e.jsx("div",{className:"p-6 text-sm text-gray-600 dark:text-gray-300",children:"Unable to load conversation data. Please refresh the page."})]});const V=t=>Array.isArray(t)?t:[],N=ht,F=pt,P=bt,Fe=yt,jt=ft,Pe=vt,{subscribe:A,connected:W}=ca(),{addToast:l}=ma(),{auth:j}=it().props,k=j?.user?.id,Re=j?.user?.notify_assignment_enabled??!0,$e=j?.user?.notify_mention_enabled??!0,Ue=j?.user?.notify_sound_enabled??!0,[R,$]=r.useState(N),[n,G]=r.useState(I),[wt,ga]=r.useState(!1),[U,J]=r.useState(!1),[Nt,He]=r.useState(!1),[kt,re]=r.useState(!1),[_t,ne]=r.useState(!1),[Ct,ie]=r.useState(!1),[St,Q]=r.useState(!1),[At,le]=r.useState(!1),[L,oe]=r.useState(null),[b,H]=r.useState([{id:"",text:""}]),[z,de]=r.useState(""),[Z,ce]=r.useState(""),[X,xe]=r.useState(""),[y,me]=r.useState([]),[O,Y]=r.useState({label:"",lat:"",lng:""}),[x,ge]=r.useState(null),[f,T]=r.useState([]),[ue,Lt]=r.useState(""),[ze,Oe]=r.useState([]),[he,ee]=r.useState(F),[pe,be]=r.useState(P),[qe,Ke]=r.useState(""),[M,Ve]=r.useState(!1),ye=r.useRef(null),We=r.useRef(null),fe=r.useRef(null),[Ge,Tt]=r.useState(!0),[Je,Qe]=r.useState(null),D=r.useRef(Math.max(...N.map(t=>t.id),0)),ve=r.useRef(new Set(N.map(t=>t.id))),w=r.useRef(Math.max(...F.map(t=>t.id),0)),E=r.useRef(Math.max(...P.map(t=>t.id),0)),je=r.useRef(Ae.assigned_to??null),{data:q,setData:we,post:Ze,processing:te,errors:Xe,reset:Ne}=Gt({message:""});r.useEffect(()=>{I&&(G(I),$(N),ee(F),be(P),D.current=Math.max(...N.map(t=>t.id),0),ve.current=new Set(N.map(t=>t.id)),w.current=Math.max(...F.map(t=>t.id),0),E.current=Math.max(...P.map(t=>t.id),0))},[I?.id,N.length,F.length,P.length]);const Ye=["ðŸ˜€","ðŸ˜","ðŸ˜‚","ðŸ¤£","ðŸ˜","ðŸ˜˜","ðŸ˜Š","ðŸ¥°","ðŸ˜Ž","ðŸ¤","ðŸ‘","ðŸ™","ðŸŽ‰","ðŸ”¥","âœ¨","ðŸ’¡","ðŸ˜¢","ðŸ˜®","ðŸ˜¡","ðŸ¤”","ðŸ˜…","ðŸ™Œ","âœ…","âŒ"],Mt=[{id:"greeting",label:"Greeting",text:"Hi! How can I help you today?"},{id:"followup",label:"Follow-up",text:"Just checking inâ€”did that solve the issue?"},{id:"thanks",label:"Thanks",text:"Thanks for reaching out! Weâ€™re on it."},{id:"handover",label:"Handover",text:"Iâ€™m looping in a specialist to assist you."}],et=jt,Dt=new Map(Fe.map(t=>[t.id,t])),tt=r.useMemo(()=>{if(!j?.user)return[];const t=j.user.name||"",a=j.user.email||"",s=t.split(" ")[0]||"",i=t.replace(/\s+/g,"");return[a,t,s,i].filter(Boolean).map(m=>`@${m.toLowerCase()}`)},[j?.user]),ke=r.useCallback(()=>{if(Ue)try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const a=new t,s=a.createOscillator(),i=a.createGain();s.type="sine",s.frequency.value=880,i.gain.value=.04,s.connect(i),i.connect(a.destination),s.start(),s.stop(a.currentTime+.12)}catch{console.warn("[Notifications] Unable to play sound")}},[Ue]),at=r.useCallback((t,a)=>{if(!$e||!k||a&&a===k)return!1;const s=t.toLowerCase();return tt.some(i=>s.includes(i))},[$e,k,tt]),Et=t=>{we("message",`${q.message||""}${t}`)};r.useEffect(()=>{const t=localStorage.getItem("waify.recentEmojis");if(t)try{const a=JSON.parse(t);Array.isArray(a)&&Oe(a.slice(0,12))}catch{console.warn("[Emoji] Failed to parse recent emojis")}},[]);const st=t=>{Et(t),Oe(a=>{const s=[t,...a.filter(i=>i!==t)].slice(0,12);return localStorage.setItem("waify.recentEmojis",JSON.stringify(s)),s})},Bt=t=>{we("message",t)},It=t=>{const a=Array.from(t.target.files||[]);a.length!==0&&(me(s=>[...s,...a]),t.target.value="",l({title:"Attachment added",description:"Attachments will be supported for sending soon.",variant:"info"}))},Ft=t=>{me(a=>a.filter((s,i)=>i!==t))},Pt=r.useCallback(async()=>{if(!L){l({title:"List needed",description:"Please select a list to send.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-list",{conversation:n.id}),{list_id:L.id}),l({title:"List sent",variant:"success"}),ie(!1),oe(null)}catch(t){l({title:"Failed to send list",description:t?.response?.data?.message||"Please try again",variant:"error"})}},[l,n.id,L,p.slug]),Rt=r.useCallback(async()=>{const t=b.filter(a=>a.id.trim()&&a.text.trim());if(t.length===0){l({title:"Buttons needed",description:"Please add at least one button.",variant:"warning"});return}if(!z.trim()){l({title:"Body text needed",description:"Please enter body text.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-buttons",{conversation:n.id}),{body_text:z,buttons:t,header_text:Z||null,footer_text:X||null}),l({title:"Interactive buttons sent",variant:"success"}),Q(!1),H([{id:"",text:""}]),de(""),ce(""),xe("")}catch(a){l({title:"Failed to send buttons",description:a?.response?.data?.message||"Please try again",variant:"error"})}},[l,n.id,b,z,Z,X,p.slug]),$t=()=>{if(b.length>=3){l({title:"Maximum 3 buttons allowed",variant:"warning"});return}H([...b,{id:"",text:""}])},Ut=t=>{const a=[...b];a.splice(t,1),a.length===0&&a.push({id:"",text:""}),H(a)},rt=(t,a,s)=>{const i=[...b];i[t]={...i[t],[a]:s},H(i)},Ht=r.useCallback(async()=>{const{label:t,lat:a,lng:s}=O;if(!a||!s){l({title:"Location needed",description:"Add latitude and longitude.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-location",{conversation:n.id}),{latitude:Number(a),longitude:Number(s),name:t||null,address:null}),l({title:"Location sent",variant:"success"}),le(!1),Y({label:"",lat:"",lng:""})}catch(i){l({title:"Failed to send location",description:i?.response?.data?.message||"Please try again",variant:"error"})}},[l,n.id,O,p.slug]),nt=r.useCallback(async t=>{if(y.length!==0){for(let a=0;a<y.length;a+=1){const s=y[a],i=s.type.startsWith("image/")?"image":s.type.startsWith("video/")?"video":"document",m=new FormData;m.append("type",i),m.append("attachment",s),t&&a===0&&m.append("caption",t);try{await S.post(route("app.whatsapp.conversations.send-media",{conversation:n.id}),m,{headers:{"Content-Type":"multipart/form-data"}})}catch(_){l({title:"Failed to send attachment",description:_?.response?.data?.message||"Please try again",variant:"error"});return}}l({title:"Attachments sent",variant:"success"}),me([])}},[l,y,n.id,p.slug]),zt=r.useCallback(async()=>{if(x)try{await S.post(route("app.whatsapp.conversations.send-template",{conversation:n.id}),{template_id:x.id,variables:f}),l({title:"Template sent",variant:"success"}),ge(null),T([]),ne(!1)}catch(t){l({title:"Failed to send template",description:t?.response?.data?.message||"Please try again",variant:"error"})}},[l,n.id,x,f,p.slug]),ae=r.useCallback(()=>{const t=fe.current;if(!t)return;const a=t.scrollHeight-t.scrollTop-t.clientHeight<150;Tt(a)},[]);r.useEffect(()=>{const t=fe.current;if(t)return t.addEventListener("scroll",ae),ae(),()=>t.removeEventListener("scroll",ae)},[ae]),r.useEffect(()=>{Ge&&R.length>0&&setTimeout(()=>{We.current?.scrollIntoView({behavior:"smooth"})},100)},[R,Ge]),r.useEffect(()=>{if(!p?.id||!n?.id)return;const t=`account.${p.id}.whatsapp.conversation.${n.id}`,a=A(t,".whatsapp.message.created",o=>{const c=o.message;c&&!ve.current.has(c.id)&&(ve.current.add(c.id),$(d=>d.find(v=>v.id===c.id)?d:[...d,c].sort((v,B)=>new Date(v.created_at).getTime()-new Date(B.created_at).getTime())),D.current=Math.max(D.current,c.id),c.direction==="inbound"&&l({title:"New message",description:c.text_body?.substring(0,50)||"New message received",variant:"info",duration:3e3}))}),s=A(t,".whatsapp.message.updated",o=>{$(c=>c.map(d=>d.id===o.message.id?{...d,status:o.message.status,error_message:o.message.error_message,sent_at:o.message.sent_at,delivered_at:o.message.delivered_at,read_at:o.message.read_at}:d))}),i=A(t,".whatsapp.conversation.updated",o=>{o.conversation&&(G(c=>({...c,status:o.conversation.status??c.status,assigned_to:o.conversation.assignee_id??c.assigned_to,priority:o.conversation.priority??c.priority})),k&&Re&&o.conversation.assignee_id===k&&je.current!==k&&(l({title:"Conversation assigned",description:"This chat was assigned to you.",variant:"info",duration:3e3}),ke()),je.current=o.conversation.assignee_id??je.current)}),m=A(t,".whatsapp.note.added",o=>{o.note&&(ee(c=>[o.note,...c]),w.current=Math.max(w.current,o.note.id),at(o.note.note||"",o.note.created_by?.id)&&(l({title:"You were mentioned",description:o.note.note?.slice(0,80)||"A note mentioned you.",variant:"info",duration:4e3}),ke()))}),_=A(t,".whatsapp.audit.added",o=>{o.audit_event&&(be(c=>[o.audit_event,...c]),E.current=Math.max(E.current,o.audit_event.id))});return()=>{a(),s(),i(),m(),_()}},[p?.id,n?.id,A,l,k,Re,at,ke]),r.useEffect(()=>{if(!p?.id||!n?.id){Je&&(clearInterval(Je),Qe(null));return}const t=async()=>{try{const i=await S.get(route("app.whatsapp.inbox.conversation.stream",{conversation:n.id}),{params:{after_message_id:D.current,after_note_id:w.current,after_audit_id:E.current}}),m=V(i.data?.new_messages),_=V(i.data?.updated_messages),o=V(i.data?.new_notes),c=V(i.data?.new_audit_events);m.length>0&&($(d=>{const v=new Set(d.map(C=>C.id)),B=m.filter(C=>!v.has(C.id));return[...d,...B].sort((C,Wt)=>new Date(C.created_at).getTime()-new Date(Wt.created_at).getTime())}),D.current=Math.max(...m.map(d=>d.id),D.current)),_.length>0&&$(d=>d.map(v=>{const B=_.find(C=>C.id===v.id);return B?{...v,...B}:v})),o.length>0&&(ee(d=>[...o.slice().reverse(),...d]),w.current=Math.max(...o.map(d=>d.id),w.current)),c.length>0&&(be(d=>[...c.slice().reverse(),...d]),E.current=Math.max(...c.map(d=>d.id),E.current)),i.data.conversation&&G(d=>({...d,...i.data.conversation}))}catch(i){console.error("[Conversation] Polling error:",i)}},s=setInterval(t,W?12e3:7e3);return Qe(s),t(),()=>{clearInterval(s)}},[W,p?.id,n?.id]);const _e=r.useCallback(async()=>{if(te)return;const t=q.message.trim();if(y.length>0){await nt(t||void 0),Ne("message");return}t&&Ze(route("app.whatsapp.conversations.send",{conversation:n.id}),{onSuccess:()=>{Ne("message"),l({title:"Message sent",variant:"success",duration:2e3})},onError:a=>{const s=Array.isArray(a?.message)?a.message[0]:a?.message,i=Array.isArray(a?.message_detail)?a.message_detail[0]:a?.message_detail,m=s==="outside_24h"||typeof s=="string"&&(s.includes("template")||s.includes("24 hour")||s.includes("recovery"));l({title:m?"Use a template to start the conversation":"Failed to send message",description:i||s||(m?"Send a template message using the template button above.":"Please try again"),variant:"error",duration:8e3}),m&&setTimeout(()=>{document.querySelector("[data-template-section]")?.scrollIntoView({behavior:"smooth",block:"nearest"})},300)}})},[te,q.message,y.length,nt,Ze,p.slug,n.id,Ne,l]),Ot=async()=>{const t=qe.trim();if(t)try{const a=await S.post(route("app.whatsapp.conversations.notes.store",{conversation:n.id}),{note:t});a.data?.note&&(ee(s=>[a.data.note,...s]),w.current=Math.max(w.current,a.data.note.id)),Ke(""),l({title:"Note added",variant:"success"})}catch(a){l({title:"Failed to add note",description:a?.response?.data?.message||"Please try again",variant:"error"})}},Ce=r.useCallback(t=>{M||(Ve(!0),Jt.post(route("app.whatsapp.conversations.update",{conversation:n.id}),t,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{G(a=>({...a,...t})),l({title:"Conversation updated",variant:"success",duration:2e3})},onError:a=>{l({title:"Update failed",description:a?.assigned_to||a?.status||a?.priority||"Please try again.",variant:"error"})},onFinish:()=>{Ve(!1)}}))},[l,n.id,M]),qt=t=>{t.preventDefault(),_e()};r.useEffect(()=>{const t=a=>{a.key==="Escape"&&U&&J(!1),(a.metaKey||a.ctrlKey)&&a.key==="Enter"&&(a.preventDefault(),_e()),(a.metaKey||a.ctrlKey)&&a.shiftKey&&(a.key.toLowerCase()==="e"&&(a.preventDefault(),He(s=>!s)),a.key.toLowerCase()==="k"&&(a.preventDefault(),re(s=>!s)),a.key.toLowerCase()==="t"&&(a.preventDefault(),ne(s=>!s)))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[U,_e]);const Kt=t=>{if(t.direction==="inbound")return null;switch(t.status){case"sent":return e.jsx(da,{className:"h-3.5 w-3.5 text-gray-400"});case"delivered":return e.jsx(xt,{className:"h-3.5 w-3.5 text-gray-400"});case"read":return e.jsx(xt,{className:"h-3.5 w-3.5 text-blue-500"});case"failed":return e.jsx("span",{className:"text-xs text-red-500 font-medium",children:"Failed"});default:return e.jsx(oa,{className:"h-3.5 w-3.5 text-gray-400"})}},Vt=t=>{const a=t.payload||{};if(t.type==="image"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:a.link,alt:"Image attachment",className:"max-h-48 rounded-lg border border-gray-200 object-cover"}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="video"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsx("video",{controls:!0,className:"max-h-48 rounded-lg border border-gray-200 w-full",children:e.jsx("source",{src:a.link})}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="document"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:a.link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-sm font-semibold text-emerald-700 hover:text-emerald-800",children:[e.jsx(ct,{className:"h-4 w-4"}),a.filename||"Document"]}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="location"&&a.latitude&&a.longitude){const s=`https://maps.google.com/?q=${a.latitude},${a.longitude}`;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:s,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-sm font-semibold text-emerald-700 hover:text-emerald-800",children:[e.jsx(dt,{className:"h-4 w-4"}),"View location"]}),a.name&&e.jsx("p",{className:"text-sm text-gray-700",children:a.name}),a.address&&e.jsx("p",{className:"text-xs text-gray-500",children:a.address})]})}return t.text_body?e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:t.text_body}):null};return e.jsxs(mt,{children:[e.jsx(lt,{title:`${n.contact.name||n.contact.wa_id} - Inbox`}),e.jsxs("div",{className:"flex flex-col h-[calc(100vh-8rem)] lg:h-[calc(100vh-6rem)] rounded-3xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-[#075E54] text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsxs(Se,{href:route("app.whatsapp.conversations.index",{}),className:"inline-flex items-center text-sm font-medium text-white/90 hover:text-white transition-colors","aria-label":"Back to conversations",children:[e.jsx(Qt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-[#25D366] flex items-center justify-center text-white font-bold text-lg shadow-lg flex-shrink-0",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:n.contact.name||n.contact.wa_id}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/80",children:[e.jsx(Zt,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:n.contact.wa_id}),e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsx("span",{className:"truncate",children:n.connection.name}),!W&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Xt,{className:"h-3 w-3 text-amber-200"}),"Polling"]})]}),W&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Yt,{className:"h-3 w-3 text-green-200"}),"Live"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"hidden sm:inline-flex rounded-full bg-white/15 px-3 py-1 text-xs uppercase tracking-wide",children:n.status}),e.jsx("button",{onClick:()=>J(!U),className:"lg:hidden p-2 rounded-lg text-white/90 hover:bg-white/10 transition-colors","aria-label":"Toggle menu",children:U?e.jsx(se,{className:"h-5 w-5"}):e.jsx(ea,{className:"h-5 w-5"})})]})]}),U&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden",onClick:()=>J(!1),"aria-hidden":"true"}),e.jsxs("div",{className:"fixed right-0 top-0 h-full w-80 bg-white dark:bg-gray-900 shadow-2xl z-50 lg:hidden p-6 border-l border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:"Conversation Info"}),e.jsx("button",{onClick:()=>J(!1),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Close conversation info",children:e.jsx(se,{className:"h-5 w-5","aria-hidden":!0})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-xl border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n.contact.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.contact.wa_id})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Connection"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:n.connection.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Status"}),e.jsx(ut,{variant:n.status==="open"?"success":"default",className:"px-3 py-1",children:n.status})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[e.jsxs("div",{ref:fe,className:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden px-4 py-6 space-y-4 bg-[#efeae2] dark:bg-gray-950 focus:outline-none",style:{backgroundImage:"radial-gradient(rgba(0,0,0,0.04) 1px, transparent 1px)",backgroundSize:"16px 16px"},tabIndex:0,children:[wt?e.jsx(e.Fragment,{children:[...Array(3)].map((t,a)=>e.jsx(xa,{},a))}):R.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-white/80 dark:bg-gray-900 mb-4 shadow-sm",children:e.jsx(ot,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium mb-1",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Start the conversation!"})]}):R.map((t,a)=>{const s=a===0||new Date(t.created_at).toDateString()!==new Date(R[a-1].created_at).toDateString();return e.jsxs("div",{children:[s&&e.jsx("div",{className:"flex items-center justify-center my-4",children:e.jsx("div",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),e.jsx("div",{className:K("flex",t.direction==="outbound"?"justify-end":"justify-start"),children:e.jsxs("div",{className:K("max-w-xs lg:max-w-md px-4 py-2.5 rounded-2xl shadow-sm",t.direction==="outbound"?"bg-[#d9fdd3] text-gray-900 rounded-tr-md":"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-tl-md"),children:[Vt(t),e.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-2",children:[e.jsx("span",{className:K("text-[11px]",t.direction==="outbound"?"text-gray-600":"text-gray-500 dark:text-gray-400"),children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),Kt(t)]})]})})]},t.id)}),e.jsx("div",{ref:We})]}),e.jsxs("aside",{className:"hidden lg:flex lg:w-80 xl:w-96 flex-col border-l border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n.contact.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.contact.wa_id})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Connection"}),e.jsx("span",{className:"font-medium",children:n.connection.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx(ut,{variant:n.status==="open"?"success":"default",className:"px-3 py-1",children:n.status})]})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Assignment & Priority"}),M&&e.jsx("span",{className:"text-xs text-gray-400",children:"Savingâ€¦"})]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Assignee"}),e.jsxs("select",{value:n.assigned_to??"",onChange:t=>{const a=t.target.value?Number(t.target.value):null;Ce({assigned_to:a})},disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"",children:"Unassigned"}),Fe.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.role,")"]},t.id))]}),n.assigned_to&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Assigned to ",Dt.get(n.assigned_to)?.name||"Unknown"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Priority"}),e.jsxs("select",{value:n.priority??"",onChange:t=>{const a=t.target.value||null;Ce({priority:a})},disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"",children:"Not set"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Status"}),e.jsxs("select",{value:n.status,onChange:t=>Ce({status:t.target.value}),disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-3 text-xs text-gray-600 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Auto-assign"}),e.jsx("div",{className:"mt-1",children:Ie?.auto_assign_enabled?`Enabled (${Ie.auto_assign_strategy.replace("_"," ")})`:"Disabled"}),e.jsx(Se,{href:route("app.settings",{}),className:"mt-2 inline-flex text-xs font-semibold text-blue-600 hover:text-blue-700 dark:text-blue-400",children:"Manage inbox settings"})]})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Internal Notes"}),e.jsx("span",{className:"text-xs text-gray-500",children:he.length})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(gt,{value:qe,onChange:t=>Ke(t.target.value),placeholder:"Add a private note...",className:"min-h-[80px] rounded-xl"}),e.jsx(u,{type:"button",onClick:Ot,className:"w-full bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Add Note"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[he.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No notes yet."}),he.map(t=>e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 p-3",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-200 whitespace-pre-wrap",children:t.note}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 dark:text-gray-400",children:[t.created_by?.name||"System"," â€¢ ",new Date(t.created_at).toLocaleString()]})]},t.id))]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Audit Events"}),e.jsx("span",{className:"text-xs text-gray-500",children:pe.length})]}),e.jsxs("div",{className:"space-y-3",children:[pe.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No audit events yet."}),pe.map(t=>e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-3",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:t.event_type.replaceAll("_"," ")}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-200",children:t.description}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 dark:text-gray-400",children:[t.actor?.name||"System"," â€¢ ",new Date(t.created_at).toLocaleString()]})]},t.id))]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-200 dark:border-gray-800 bg-[#f0f2f5] dark:bg-gray-900 p-3 sticky bottom-0",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>He(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ta,{className:"h-3.5 w-3.5"}),"Emoji"]}),e.jsxs("button",{type:"button",onClick:()=>ye.current?.click(),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(aa,{className:"h-3.5 w-3.5"}),"Attach"]}),e.jsxs("button",{type:"button",onClick:()=>ye.current?.click(),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(sa,{className:"h-3.5 w-3.5"}),"Photo/Video"]}),e.jsxs("button",{type:"button",onClick:()=>le(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(dt,{className:"h-3.5 w-3.5"}),"Location"]}),e.jsxs("button",{type:"button","data-template-section":!0,onClick:()=>ne(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300","aria-label":"Send template message",children:[e.jsx(ct,{className:"h-3.5 w-3.5"}),"Templates"]}),e.jsxs("button",{type:"button",onClick:()=>{ie(t=>!t),Q(!1)},className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ra,{className:"h-3.5 w-3.5"}),"Lists"]}),e.jsxs("button",{type:"button",onClick:()=>{Q(t=>!t),ie(!1)},className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(na,{className:"h-3.5 w-3.5"}),"Buttons"]}),e.jsxs("button",{type:"button",onClick:()=>re(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ia,{className:"h-3.5 w-3.5"}),"Quick Replies"]}),e.jsx("input",{ref:ye,type:"file",multiple:!0,accept:"image/*,video/*,application/pdf",className:"hidden",onChange:It})]}),Nt&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-3 z-20 flex flex-wrap items-center gap-2 rounded-2xl border border-gray-200 bg-white/95 p-3 text-lg shadow-lg dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("div",{className:"w-full",children:e.jsx(h,{value:ue,onChange:t=>Lt(t.target.value),placeholder:"Search emojis",className:"rounded-xl text-sm"})}),ze.length>0&&e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"mb-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:"Recent"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ze.map(t=>e.jsx("button",{type:"button",onClick:()=>st(t),className:"rounded-lg px-2 py-1 hover:bg-gray-100 dark:hover:bg-gray-700",children:t},`recent-${t}`))})]}),(ue.trim()?Ye.filter(t=>t.includes(ue.trim())):Ye).map(t=>e.jsx("button",{type:"button",onClick:()=>st(t),className:"rounded-lg px-2 py-1 hover:bg-gray-100 dark:hover:bg-gray-700",children:t},t))]})]}),At&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsx(h,{value:O.label,onChange:t=>Y(a=>({...a,label:t.target.value})),placeholder:"Label (optional)",className:"rounded-xl"}),e.jsx(h,{value:O.lat,onChange:t=>Y(a=>({...a,lat:t.target.value})),placeholder:"Latitude",className:"rounded-xl"}),e.jsx(h,{value:O.lng,onChange:t=>Y(a=>({...a,lng:t.target.value})),placeholder:"Longitude",className:"rounded-xl"})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>le(!1),children:"Cancel"}),e.jsx(u,{type:"button",onClick:Ht,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Location"})]})]}),kt&&e.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:e.jsx("div",{className:"grid gap-2",children:Mt.map(t=>e.jsxs("button",{type:"button",onClick:()=>{Bt(t.text),re(!1)},className:"w-full rounded-xl border border-gray-200 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-700",children:[e.jsx("p",{className:"font-semibold",children:t.label}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.text})]},t.id))})}),_t&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800","data-template-section":!0,children:[e.jsxs("div",{className:"grid gap-3",children:[et.length===0&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No approved templates found for this connection."}),et.map(t=>e.jsxs("button",{type:"button",onClick:()=>{ge(t),T(Array.from({length:t.variable_count||0},()=>""))},className:K("w-full rounded-xl border px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700",x?.id===t.id?"border-emerald-400 bg-emerald-50/70 text-emerald-900 dark:border-emerald-500/70 dark:bg-emerald-500/10 dark:text-emerald-100":"border-gray-200 text-gray-700 dark:border-gray-700 dark:text-gray-200"),children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.body_text||"Template message"})]},t.id))]}),x&&e.jsxs("div",{className:"mt-4 rounded-xl border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("div",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-200",children:"Fill template variables"}),f.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This template has no variables."}),e.jsxs("div",{className:"grid gap-4",children:[x.header_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Header variables"}),f.slice(0,x.header_count).map((t,a)=>e.jsx(h,{value:t,onChange:s=>{const i=[...f];i[a]=s.target.value,T(i)},placeholder:`Header variable ${a+1}`,className:"rounded-xl"},`${x.id}-header-${a}`))]}),x.body_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Body variables"}),f.slice(x.header_count,x.header_count+x.body_count).map((t,a)=>e.jsx(h,{value:t,onChange:s=>{const i=[...f];i[x.header_count+a]=s.target.value,T(i)},placeholder:`Body variable ${a+1}`,className:"rounded-xl"},`${x.id}-body-${a}`))]}),x.button_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Button variables"}),f.slice(x.header_count+x.body_count,x.variable_count).map((t,a)=>e.jsx(h,{value:t,onChange:s=>{const i=[...f];i[x.header_count+x.body_count+a]=s.target.value,T(i)},placeholder:`Button variable ${a+1}`,className:"rounded-xl"},`${x.id}-button-${a}`))]})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>{ge(null),T([])},children:"Clear"}),e.jsx(u,{type:"button",onClick:zt,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Template"})]})]})]}),Ct&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsxs("div",{className:"grid gap-3",children:[Pe.length===0&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["No lists available."," ",e.jsx(Se,{href:route("app.whatsapp.lists.index"),className:"font-medium text-emerald-600 hover:text-emerald-500 dark:text-emerald-400 dark:hover:text-emerald-300",children:"Create lists in the Lists section"}),"."]}),Pe.map(t=>e.jsxs("button",{type:"button",onClick:()=>oe(t),className:K("w-full rounded-xl border px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700",L?.id===t.id?"border-emerald-400 bg-emerald-50/70 text-emerald-900 dark:border-emerald-500/70 dark:bg-emerald-500/10 dark:text-emerald-100":"border-gray-200 text-gray-700 dark:border-gray-700 dark:text-gray-200"),children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.description||t.button_text})]},t.id))]}),L&&e.jsxs("div",{className:"mt-4 rounded-xl border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[e.jsxs("div",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-200",children:["Selected List: ",L.name]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>{oe(null)},children:"Clear"}),e.jsx(u,{type:"button",onClick:Pt,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send List"})]})]})]}),St&&e.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Body Text * (Max 1024 chars)"}),e.jsx(gt,{value:z,onChange:t=>de(t.target.value),placeholder:"Enter message body text",maxLength:1024,rows:3,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[z.length,"/1024 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Header Text (Optional, Max 60 chars)"}),e.jsx(h,{value:Z,onChange:t=>ce(t.target.value),placeholder:"Optional header text",maxLength:60,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Z.length,"/60 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Footer Text (Optional, Max 60 chars)"}),e.jsx(h,{value:X,onChange:t=>xe(t.target.value),placeholder:"Optional footer text",maxLength:60,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[X.length,"/60 characters"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Buttons (Max 3)"}),b.length<3&&e.jsxs(u,{type:"button",onClick:$t,variant:"secondary",size:"sm",children:[e.jsx(la,{className:"h-3 w-3 mr-1"}),"Add Button"]})]}),e.jsx("div",{className:"space-y-2",children:b.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-2 border border-gray-200 dark:border-gray-700 rounded-lg p-2",children:[e.jsx(h,{value:t.id,onChange:s=>rt(a,"id",s.target.value),placeholder:"Button ID (unique)",maxLength:256,className:"flex-1 text-sm rounded-lg"}),e.jsx(h,{value:t.text,onChange:s=>rt(a,"text",s.target.value),placeholder:"Button text (max 20)",maxLength:20,className:"flex-1 text-sm rounded-lg"}),b.length>1&&e.jsx(u,{type:"button",onClick:()=>Ut(a),variant:"ghost",size:"sm",children:e.jsx(se,{className:"h-3 w-3 text-red-500"})})]},a))})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>{Q(!1),H([{id:"",text:""}]),de(""),ce(""),xe("")},children:"Cancel"}),e.jsx(u,{type:"button",onClick:Rt,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Buttons"})]})]})}),y.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((t,a)=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white px-3 py-1 text-xs text-gray-600 shadow-sm dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("span",{className:"truncate max-w-[160px]",children:t.name}),e.jsx("button",{type:"button",onClick:()=>Ft(a),className:"text-gray-400 hover:text-gray-600","aria-label":`Remove ${t.name}`,children:e.jsx(se,{className:"h-3.5 w-3.5","aria-hidden":!0})})]},`${t.name}-${a}`))}),e.jsxs("form",{onSubmit:qt,className:"flex items-center gap-3",children:[e.jsx(h,{value:q.message,onChange:t=>we("message",t.target.value),placeholder:"Type a message",className:"flex-1 rounded-full bg-white dark:bg-gray-800",disabled:te,autoFocus:!0,"aria-label":"Message input"}),e.jsx(u,{type:"submit",disabled:te||!q.message.trim()&&y.length===0,"aria-label":"Send message",className:"bg-[#25D366] hover:bg-[#1DAA57] text-white rounded-full px-5",children:e.jsx(ot,{className:"h-4 w-4"})})]})]}),Xe.message&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2",role:"alert",children:Xe.message})]})]})]})}export{La as default};
