import{j as e}from"./react-BhzSerM2.js";import{G as C,H as _,l as u,N as S,a0 as F,X as q}from"./vendor-DxGhd0kb.js";import{A}from"./AppShell-BB77liAb.js";import{C as p,b as x,c as h,d as g,a as v}from"./Card-DyITSrT5.js";import{B as o}from"./app-CUdtZvAA.js";import{T as j}from"./TextInput-DRXLElIV.js";import{I as n}from"./InputLabel-qVeuR0hO.js";import{I}from"./InputError-6mWSc7R2.js";import{u as T}from"./useToast-m6H8bvjE.js";import"./Topbar-DS5R2nuh.js";import"./Badge-Dmpsa1zd.js";import"./GlobalFlashHandler-xHP6pVTU.js";import"./BrandingWrapper-DK418oSm.js";import"./Alert-0kUZKT4N.js";import"./CookieConsentBanner-DBs8YRGi.js";/* empty css            */const D=[{value:"equals",label:"equals"},{value:"not_equals",label:"not equals"},{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"},{value:"starts_with",label:"starts with"},{value:"ends_with",label:"ends with"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}];function Y({account:E,filter_fields:m}){const{toast:c}=T(),{data:r,setData:l,post:b,processing:y,errors:f}=C({name:"",description:"",filters:[]}),N=()=>{l("filters",[...r.filters,{field:m[0]?.value??"name",operator:"equals",value:""}])},w=s=>{l("filters",r.filters.filter((t,a)=>a!==s))},i=(s,t,a)=>{const d=[...r.filters];d[s]={...d[s],[t]:a},l("filters",d)},k=s=>{s.preventDefault(),b(route("app.contacts.segments.store"),{onSuccess:()=>c.success("Segment created"),onError:()=>c.error("Failed to create segment")})};return e.jsxs(A,{children:[e.jsx(_,{title:"New Segment"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(u,{href:route("app.contacts.segments.index"),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 mb-4",children:[e.jsx(S,{className:"h-4 w-4"}),"Back to Segments"]}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent",children:"New Segment"})]}),e.jsxs("form",{onSubmit:k,children:[e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Segment details"}),e.jsx(g,{children:"Name and optional description"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{value:"Name *"}),e.jsx(j,{value:r.name,onChange:s=>l("name",s.target.value),className:"mt-1 w-full max-w-md",required:!0}),e.jsx(I,{message:f.name})]}),e.jsxs("div",{children:[e.jsx(n,{value:"Description (optional)"}),e.jsx("textarea",{value:r.description,onChange:s=>l("description",s.target.value),className:"mt-1 w-full max-w-md rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800 px-3 py-2",rows:2})]})]})]}),e.jsxs(p,{className:"mt-6",children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Filters"}),e.jsx(g,{children:"Contacts that match all rules below will be in this segment"})]}),e.jsxs(o,{type:"button",variant:"secondary",size:"sm",onClick:N,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add rule"]})]})}),e.jsx(v,{className:"space-y-4",children:r.filters.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No filters. Add a rule to limit which contacts are in this segment, or leave empty to leave the segment empty until you add rules later."}):r.filters.map((s,t)=>e.jsxs("div",{className:"flex flex-wrap items-end gap-2 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{className:"w-40",children:[e.jsx(n,{value:"Field"}),e.jsx("select",{value:s.field,onChange:a=>i(t,"field",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800",children:m.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"w-36",children:[e.jsx(n,{value:"Operator"}),e.jsx("select",{value:s.operator,onChange:a=>i(t,"operator",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-700 dark:bg-gray-800",children:D.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),s.operator!=="is_empty"&&s.operator!=="is_not_empty"&&e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx(n,{value:"Value"}),e.jsx(j,{value:s.value,onChange:a=>i(t,"value",a.target.value),className:"mt-1"})]}),e.jsx(o,{type:"button",variant:"secondary",size:"sm",onClick:()=>w(t),children:e.jsx(q,{className:"h-4 w-4"})})]},t))})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx(o,{type:"submit",disabled:y,children:"Create segment"}),e.jsx(u,{href:route("app.contacts.segments.index"),children:e.jsx(o,{type:"button",variant:"secondary",children:"Cancel"})})]})]})]})]})}export{Y as default};
