import{r,j as e}from"./react-BhzSerM2.js";import{ac as _,ad as k,ae as C,a0 as E,af as S,ag as w,ah as B,ai as F,ab as M,B as $}from"./vendor-DxGhd0kb.js";import{B as d}from"./app-CHptu5EX.js";import{B as z}from"./Badge-DOejrt-x.js";/* empty css            */function T({flow:i,onEditNode:u,onAddNode:g,onDeleteNode:N,onSelectEdge:G,onSaveGraph:b}){const o=r.useMemo(()=>(i.nodes||[]).map(s=>({id:String(s.id),position:{x:s.pos_x??s.sort_order*180,y:s.pos_y??120},data:{label:`${s.type}${s.config?.is_start?" (start)":""}`,meta:s},style:{borderRadius:12,border:"1px solid #E2E8F0",padding:12,background:"#fff",minWidth:140}})),[i.nodes]),n=r.useMemo(()=>(i.edges||[]).map(s=>({id:String(s.id),source:String(s.from_node_id),target:String(s.to_node_id),label:s.label||"next",animated:s.label==="true"||s.label==="false",style:{stroke:"#6366F1"}})),[i.edges]),[m,x]=r.useState(o),[p,l]=r.useState(n);r.useEffect(()=>{x(o)},[o]),r.useEffect(()=>{l(n)},[n]);const y=r.useCallback(s=>{x(t=>_(s,t))},[]),j=r.useCallback(s=>{l(t=>k(s,t))},[]),f=r.useCallback(s=>{l(t=>C({...s,id:`temp-${Date.now()}`,label:"next",style:{stroke:"#6366F1"}},t))},[]),v=()=>{const s=m.map((a,c)=>{const h=a.data?.meta;return{...h,sort_order:h?.sort_order??c+1,pos_x:Math.round(a.position.x),pos_y:Math.round(a.position.y)}}),t=p.map((a,c)=>({id:a.id&&!Number.isNaN(Number(a.id))?Number(a.id):0,from_node_id:Number(a.source),to_node_id:Number(a.target),label:a.label||"next",sort_order:c+1}));b({nodes:s,edges:t})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Flow Graph"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Drag nodes and connect them to create branches. Click “Save Graph” to persist."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:g,children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Add Node"]}),e.jsx(d,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:v,children:"Save Graph"})]})]}),e.jsx("div",{className:"h-[420px] rounded-xl border border-gray-200 dark:border-gray-700 bg-white",children:e.jsxs(S,{nodes:m,edges:p,onNodesChange:y,onEdgesChange:j,onConnect:f,fitView:!0,children:[e.jsx(w,{}),e.jsx(B,{}),e.jsx(F,{gap:16,size:1})]})}),e.jsx("div",{className:"space-y-2",children:(i.nodes||[]).map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.type}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Order: ",s.sort_order]}),(s.config?.is_start??!1)&&e.jsx(z,{variant:"info",className:"mt-2",children:"Start"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"ghost",size:"sm",className:"rounded-lg",onClick:()=>u(s),children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(d,{variant:"ghost",size:"sm",className:"rounded-lg",onClick:()=>N(s.id),children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]},s.id))})]})}export{T as default};
