import{j as e}from"./react-BhzSerM2.js";import{C as t,b as r,c as l,d as c,a as d}from"./Card-CRSrZ5HZ.js";import{A as m,aV as o,D as j,M as g,aJ as b,i as h,T as p}from"./vendor-YQoUUhbX.js";import"./app-DjsbE74r.js";/* empty css            */function u(s){return s>=85?{label:"Healthy",cls:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"}:s>=60?{label:"Warning",cls:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300"}:{label:"Critical",cls:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}}const i=s=>s?new Date(s).toLocaleString():"N/A";function w({delivery:s}){const x=u(s.health_score);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5"}),"Delivery & Trigger Health"]}),e.jsxs(c,{children:["Generated at ",i(s.generated_at)]})]}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 bg-slate-50 p-4 dark:border-slate-700 dark:bg-slate-900",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Overall health score"}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100",children:s.health_score})]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-semibold ${x.cls}`,children:x.label})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2 text-base",children:[e.jsx(o,{className:"h-4 w-4"}),"Queue"]})}),e.jsxs(d,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:["Pending total: ",e.jsx("strong",{children:s.queue.pending_total})]}),e.jsxs("div",{children:["Failed (1h): ",e.jsx("strong",{children:s.queue.failed_last_hour})]}),e.jsxs("div",{children:["Failed (24h): ",e.jsx("strong",{children:s.queue.failed_last_24h})]}),e.jsxs("div",{children:["Oldest pending: ",e.jsx("strong",{children:i(s.queue.oldest_pending_at)})]}),e.jsx("div",{className:"pt-2",children:Object.entries(s.queue.pending_by_queue).map(([a,n])=>e.jsxs("div",{className:"flex items-center justify-between rounded-md bg-gray-50 px-2 py-1 dark:bg-gray-800",children:[e.jsx("span",{children:a}),e.jsx("strong",{children:n})]},a))})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2 text-base",children:[e.jsx(j,{className:"h-4 w-4"}),"Email"]})}),e.jsxs(d,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:["Driver: ",e.jsx("strong",{children:s.mail.driver})]}),e.jsxs("div",{children:["Mail-related failures (24h): ",e.jsx("strong",{children:s.mail.mail_related_failures_last_24h})]}),e.jsxs("div",{children:["Notification failures (24h): ",e.jsx("strong",{children:s.mail.notification_failures_last_24h})]}),e.jsxs("div",{children:["Failover enabled: ",e.jsx("strong",{children:s.mail.fallback_enabled?"Yes":"No"})]}),e.jsxs("div",{children:["Last fallback: ",e.jsx("strong",{children:i(s.mail.fallback_last_triggered_at)})]}),s.mail.fallback_last_error&&e.jsxs("div",{className:"rounded-md border border-amber-200 bg-amber-50 p-2 text-xs text-amber-700 dark:border-amber-900/40 dark:bg-amber-900/20 dark:text-amber-200",children:["Last fallback error: ",s.mail.fallback_last_error]}),e.jsx("div",{className:"pt-2 text-xs text-slate-500 dark:text-slate-400",children:"Template diagnostics (last 7 days)"}),s.mail.template_diagnostics.length===0?e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"No outbox diagnostics yet."}):e.jsx("div",{className:"space-y-1",children:s.mail.template_diagnostics.map(a=>e.jsxs("div",{className:"rounded-md bg-gray-50 p-2 text-xs dark:bg-gray-800",children:[e.jsx("div",{className:"font-semibold",children:a.template_key}),e.jsxs("div",{className:"mt-1",children:["total: ",e.jsx("strong",{children:a.total})," | sent: ",e.jsx("strong",{children:a.sent})," | failed: ",e.jsx("strong",{children:a.failed})," | queued/retrying: ",e.jsx("strong",{children:a.queued+a.retrying})]})]},a.template_key))})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2 text-base",children:[e.jsx(g,{className:"h-4 w-4"}),"Triggers"]})}),e.jsxs(d,{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Chatbots (24h)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(s.triggers.chatbots_24h).map(([a,n])=>e.jsxs("div",{className:"rounded-md bg-gray-50 px-2 py-1 dark:bg-gray-800",children:[a,": ",e.jsx("strong",{children:n})]},a))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-1 font-semibold",children:"Campaigns (24h)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(s.triggers.campaigns_24h).map(([a,n])=>e.jsxs("div",{className:"rounded-md bg-gray-50 px-2 py-1 dark:bg-gray-800",children:[a,": ",e.jsx("strong",{children:n})]},a))})]})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-4 w-4"}),"Webhooks"]})}),e.jsxs(d,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:["Active connections: ",e.jsx("strong",{children:s.webhooks.active_connections})]}),e.jsxs("div",{children:["Healthy: ",e.jsx("strong",{children:s.webhooks.healthy_connections})]}),e.jsxs("div",{children:["Stale: ",e.jsx("strong",{children:s.webhooks.stale_connections})]}),e.jsxs("div",{children:["With errors: ",e.jsx("strong",{children:s.webhooks.connections_with_errors})]}),e.jsxs("div",{children:["Last webhook: ",e.jsx("strong",{children:i(s.webhooks.last_webhook_at)})]})]})]})]}),e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsx(l,{className:"text-base",children:"Recent Failures"}),e.jsx(c,{children:"Latest failed jobs from queue workers."})]}),e.jsx(d,{children:s.recent_failures.length===0?e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-green-50 p-3 text-sm text-green-700 dark:bg-green-900/20 dark:text-green-300",children:[e.jsx(h,{className:"h-4 w-4"}),"No recent failures."]}):e.jsx("div",{className:"space-y-2",children:s.recent_failures.map(a=>e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3 text-sm dark:border-red-900/40 dark:bg-red-900/20",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 font-semibold text-red-700 dark:text-red-300",children:[e.jsx(p,{className:"h-4 w-4"}),"Queue: ",a.queue]}),e.jsx("span",{className:"text-xs text-red-700/80 dark:text-red-300/80",children:i(a.failed_at)})]}),e.jsx("div",{className:"text-xs text-red-800 dark:text-red-200",children:a.error})]},a.id))})})]}),e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsx(l,{className:"text-base",children:"Recent Email Delivery Failures"}),e.jsx(c,{children:"Template-level diagnostics from notification outbox."})]}),e.jsx(d,{children:s.mail.recent_outbox_failures.length===0?e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-green-50 p-3 text-sm text-green-700 dark:bg-green-900/20 dark:text-green-300",children:[e.jsx(h,{className:"h-4 w-4"}),"No recent email delivery failures."]}):e.jsx("div",{className:"space-y-2",children:s.mail.recent_outbox_failures.map((a,n)=>e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-3 text-sm dark:border-amber-900/40 dark:bg-amber-900/20",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between gap-3",children:[e.jsx("span",{className:"font-semibold text-amber-800 dark:text-amber-200",children:a.template_key}),e.jsx("span",{className:"text-xs text-amber-700/80 dark:text-amber-300/80",children:i(a.failed_at)})]}),e.jsxs("div",{className:"text-xs text-amber-900 dark:text-amber-100",children:["recipient: ",a.recipient||"unknown"," | code: ",a.provider_code||"n/a"]}),a.failure_reason&&e.jsx("div",{className:"mt-1 text-xs text-amber-800 dark:text-amber-200",children:a.failure_reason})]},`${a.template_key}-${a.failed_at}-${n}`))})})]}),e.jsxs(t,{children:[e.jsxs(r,{children:[e.jsx(l,{className:"text-base",children:"Backups"}),e.jsx(c,{children:"Automated database backup and restore drill status."})]}),e.jsxs(d,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:["Latest backup status: ",e.jsx("strong",{children:s.backups.latest_status||"N/A"})]}),e.jsxs("div",{children:["Latest completed at: ",e.jsx("strong",{children:i(s.backups.latest_completed_at)})]}),e.jsxs("div",{children:["Latest restore drill: ",e.jsx("strong",{children:s.backups.latest_restore_drill_status||"N/A"})]}),e.jsxs("div",{children:["Restore drill at: ",e.jsx("strong",{children:i(s.backups.latest_restore_drill_at)})]})]})]})]})}export{w as default};
