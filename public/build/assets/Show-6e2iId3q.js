import{j as e,r}from"./react-BhzSerM2.js";import{u as nt,H as it,G as Wt,a as S,e as Gt,l as Ce,N as Jt,aT as Qt,b1 as Zt,b0 as Xt,X as ae,as as Yt,k as lt,b2 as ea,b3 as ta,b4 as aa,aW as dt,F as ot,b5 as sa,b6 as ra,Z as na,a0 as ia,f as la,b7 as ct,$ as da}from"./vendor-DxGhd0kb.js";import{A as xt}from"./AppShell-Cc2RD8Vl.js";import{a as oa,c as q,B as h}from"./app-Iwsu59co.js";import{T as p}from"./TextInput-DRXLElIV.js";import{T as mt}from"./Textarea-B-2hwyIh.js";import{B as gt}from"./Badge-i1wYvjg_.js";import{M as ca}from"./Skeleton-CfTHwkjJ.js";import{u as xa}from"./useToast-m6H8bvjE.js";import"./Topbar-DdwsMJGZ.js";import"./GlobalFlashHandler-xHP6pVTU.js";import"./BrandingWrapper-DK418oSm.js";import"./Alert-CNardO3g.js";import"./CookieConsentBanner-CkGeiZeY.js";/* empty css            */function Aa({account:u,conversation:Se,messages:Ae=[],templates:Le=[],lists:Te=[],notes:Me=[],audit_events:De=[],agents:Ee=[],inbox_settings:Be={auto_assign_enabled:!1,auto_assign_strategy:"round_robin"}}){const m=nt().props,B=Se??m?.conversation??null,ut=Array.isArray(Ae)?Ae:Array.isArray(m?.messages)?m.messages:[],ht=Array.isArray(Me)?Me:Array.isArray(m?.notes)?m.notes:[],pt=Array.isArray(De)?De:Array.isArray(m?.audit_events)?m.audit_events:[],bt=Array.isArray(Ee)?Ee:Array.isArray(m?.agents)?m.agents:[],yt=Array.isArray(Le)?Le:Array.isArray(m?.templates)?m.templates:[],ft=Array.isArray(Te)?Te:Array.isArray(m?.lists)?m.lists:[];if(!B)return e.jsxs(xt,{children:[e.jsx(it,{title:"Conversation"}),e.jsx("div",{className:"p-6 text-sm text-gray-600 dark:text-gray-300",children:"Unable to load conversation data. Please refresh the page."})]});const K=t=>Array.isArray(t)?t:[],_=ut,I=ht,F=pt,Ie=bt,vt=yt,Fe=ft,{subscribe:A,connected:V}=oa(),{addToast:d}=xa(),{auth:j}=nt().props,C=j?.user?.id,Pe=j?.user?.notify_assignment_enabled??!0,Re=j?.user?.notify_mention_enabled??!0,$e=j?.user?.notify_sound_enabled??!0,[P,R]=r.useState(_),[n,W]=r.useState(B),[jt,ma]=r.useState(!1),[$,G]=r.useState(!1),[wt,Ue]=r.useState(!1),[Nt,se]=r.useState(!1),[kt,re]=r.useState(!1),[_t,ne]=r.useState(!1),[Ct,J]=r.useState(!1),[St,ie]=r.useState(!1),[L,le]=r.useState(null),[b,U]=r.useState([{id:"",text:""}]),[H,de]=r.useState(""),[Q,oe]=r.useState(""),[Z,ce]=r.useState(""),[y,xe]=r.useState([]),[z,X]=r.useState({label:"",lat:"",lng:""}),[c,me]=r.useState(null),[f,T]=r.useState([]),[ge,At]=r.useState(""),[He,ze]=r.useState([]),[ue,Y]=r.useState(I),[he,pe]=r.useState(F),[Oe,qe]=r.useState(""),[M,Ke]=r.useState(!1),be=r.useRef(null),Ve=r.useRef(null),ye=r.useRef(null),[We,Lt]=r.useState(!0),[Ge,Je]=r.useState(null),D=r.useRef(Math.max(..._.map(t=>t.id),0)),fe=r.useRef(new Set(_.map(t=>t.id))),w=r.useRef(Math.max(...I.map(t=>t.id),0)),E=r.useRef(Math.max(...F.map(t=>t.id),0)),ve=r.useRef(Se.assigned_to??null),{data:O,setData:je,post:Qe,processing:ee,errors:Ze,reset:we}=Wt({message:""});r.useEffect(()=>{B&&(W(B),R(_),Y(I),pe(F),D.current=Math.max(..._.map(t=>t.id),0),fe.current=new Set(_.map(t=>t.id)),w.current=Math.max(...I.map(t=>t.id),0),E.current=Math.max(...F.map(t=>t.id),0))},[B?.id,_.length,I.length,F.length]);const Xe=["ðŸ˜€","ðŸ˜","ðŸ˜‚","ðŸ¤£","ðŸ˜","ðŸ˜˜","ðŸ˜Š","ðŸ¥°","ðŸ˜Ž","ðŸ¤","ðŸ‘","ðŸ™","ðŸŽ‰","ðŸ”¥","âœ¨","ðŸ’¡","ðŸ˜¢","ðŸ˜®","ðŸ˜¡","ðŸ¤”","ðŸ˜…","ðŸ™Œ","âœ…","âŒ"],Tt=[{id:"greeting",label:"Greeting",text:"Hi! How can I help you today?"},{id:"followup",label:"Follow-up",text:"Just checking inâ€”did that solve the issue?"},{id:"thanks",label:"Thanks",text:"Thanks for reaching out! Weâ€™re on it."},{id:"handover",label:"Handover",text:"Iâ€™m looping in a specialist to assist you."}],Ye=vt,Mt=new Map(Ie.map(t=>[t.id,t])),et=r.useMemo(()=>{if(!j?.user)return[];const t=j.user.name||"",a=j.user.email||"",s=t.split(" ")[0]||"",i=t.replace(/\s+/g,"");return[a,t,s,i].filter(Boolean).map(x=>`@${x.toLowerCase()}`)},[j?.user]),Ne=r.useCallback(()=>{if($e)try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const a=new t,s=a.createOscillator(),i=a.createGain();s.type="sine",s.frequency.value=880,i.gain.value=.04,s.connect(i),i.connect(a.destination),s.start(),s.stop(a.currentTime+.12)}catch{console.warn("[Notifications] Unable to play sound")}},[$e]),tt=r.useCallback((t,a)=>{if(!Re||!C||a&&a===C)return!1;const s=t.toLowerCase();return et.some(i=>s.includes(i))},[Re,C,et]),Dt=t=>{je("message",`${O.message||""}${t}`)};r.useEffect(()=>{const t=localStorage.getItem("waify.recentEmojis");if(t)try{const a=JSON.parse(t);Array.isArray(a)&&ze(a.slice(0,12))}catch{console.warn("[Emoji] Failed to parse recent emojis")}},[]);const at=t=>{Dt(t),ze(a=>{const s=[t,...a.filter(i=>i!==t)].slice(0,12);return localStorage.setItem("waify.recentEmojis",JSON.stringify(s)),s})},Et=t=>{je("message",t)},Bt=t=>{const a=Array.from(t.target.files||[]);a.length!==0&&(xe(s=>[...s,...a]),t.target.value="",d({title:"Attachment added",description:"Attachments will be supported for sending soon.",variant:"info"}))},It=t=>{xe(a=>a.filter((s,i)=>i!==t))},Ft=r.useCallback(async()=>{if(!L){d({title:"List needed",description:"Please select a list to send.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-list",{conversation:n.id}),{list_id:L.id}),d({title:"List sent",variant:"success"}),ne(!1),le(null)}catch(t){d({title:"Failed to send list",description:t?.response?.data?.message||"Please try again",variant:"error"})}},[d,n.id,L,u.slug]),Pt=r.useCallback(async()=>{const t=b.filter(a=>a.id.trim()&&a.text.trim());if(t.length===0){d({title:"Buttons needed",description:"Please add at least one button.",variant:"warning"});return}if(!H.trim()){d({title:"Body text needed",description:"Please enter body text.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-buttons",{conversation:n.id}),{body_text:H,buttons:t,header_text:Q||null,footer_text:Z||null}),d({title:"Interactive buttons sent",variant:"success"}),J(!1),U([{id:"",text:""}]),de(""),oe(""),ce("")}catch(a){d({title:"Failed to send buttons",description:a?.response?.data?.message||"Please try again",variant:"error"})}},[d,n.id,b,H,Q,Z,u.slug]),Rt=()=>{if(b.length>=3){d({title:"Maximum 3 buttons allowed",variant:"warning"});return}U([...b,{id:"",text:""}])},$t=t=>{const a=[...b];a.splice(t,1),a.length===0&&a.push({id:"",text:""}),U(a)},st=(t,a,s)=>{const i=[...b];i[t]={...i[t],[a]:s},U(i)},Ut=r.useCallback(async()=>{const{label:t,lat:a,lng:s}=z;if(!a||!s){d({title:"Location needed",description:"Add latitude and longitude.",variant:"warning"});return}try{await S.post(route("app.whatsapp.conversations.send-location",{conversation:n.id}),{latitude:Number(a),longitude:Number(s),name:t||null,address:null}),d({title:"Location sent",variant:"success"}),ie(!1),X({label:"",lat:"",lng:""})}catch(i){d({title:"Failed to send location",description:i?.response?.data?.message||"Please try again",variant:"error"})}},[d,n.id,z,u.slug]),rt=r.useCallback(async t=>{if(y.length!==0){for(let a=0;a<y.length;a+=1){const s=y[a],i=s.type.startsWith("image/")?"image":s.type.startsWith("video/")?"video":"document",x=new FormData;x.append("type",i),x.append("attachment",s),t&&a===0&&x.append("caption",t);try{await S.post(route("app.whatsapp.conversations.send-media",{conversation:n.id}),x,{headers:{"Content-Type":"multipart/form-data"}})}catch(N){d({title:"Failed to send attachment",description:N?.response?.data?.message||"Please try again",variant:"error"});return}}d({title:"Attachments sent",variant:"success"}),xe([])}},[d,y,n.id,u.slug]),Ht=r.useCallback(async()=>{if(c)try{await S.post(route("app.whatsapp.conversations.send-template",{conversation:n.id}),{template_id:c.id,variables:f}),d({title:"Template sent",variant:"success"}),me(null),T([]),re(!1)}catch(t){d({title:"Failed to send template",description:t?.response?.data?.message||"Please try again",variant:"error"})}},[d,n.id,c,f,u.slug]),te=r.useCallback(()=>{const t=ye.current;if(!t)return;const a=t.scrollHeight-t.scrollTop-t.clientHeight<150;Lt(a)},[]);r.useEffect(()=>{const t=ye.current;if(t)return t.addEventListener("scroll",te),te(),()=>t.removeEventListener("scroll",te)},[te]),r.useEffect(()=>{We&&P.length>0&&setTimeout(()=>{Ve.current?.scrollIntoView({behavior:"smooth"})},100)},[P,We]),r.useEffect(()=>{if(!u?.id||!n?.id)return;const t=`account.${u.id}.whatsapp.conversation.${n.id}`,a=A(t,".whatsapp.message.created",o=>{const l=o.message;l&&!fe.current.has(l.id)&&(fe.current.add(l.id),R(g=>g.find(k=>k.id===l.id)?g:[...g,l].sort((k,v)=>new Date(k.created_at).getTime()-new Date(v.created_at).getTime())),D.current=Math.max(D.current,l.id),l.direction==="inbound"&&d({title:"New message",description:l.text_body?.substring(0,50)||"New message received",variant:"info",duration:3e3}))}),s=A(t,".whatsapp.message.updated",o=>{R(l=>l.map(g=>g.id===o.message.id?{...g,status:o.message.status,error_message:o.message.error_message,sent_at:o.message.sent_at,delivered_at:o.message.delivered_at,read_at:o.message.read_at}:g))}),i=A(t,".whatsapp.conversation.updated",o=>{o.conversation&&(W(l=>({...l,status:o.conversation.status??l.status,assigned_to:o.conversation.assignee_id??l.assigned_to,priority:o.conversation.priority??l.priority})),C&&Pe&&o.conversation.assignee_id===C&&ve.current!==C&&(d({title:"Conversation assigned",description:"This chat was assigned to you.",variant:"info",duration:3e3}),Ne()),ve.current=o.conversation.assignee_id??ve.current)}),x=A(t,".whatsapp.note.added",o=>{o.note&&(Y(l=>[o.note,...l]),w.current=Math.max(w.current,o.note.id),tt(o.note.note||"",o.note.created_by?.id)&&(d({title:"You were mentioned",description:o.note.note?.slice(0,80)||"A note mentioned you.",variant:"info",duration:4e3}),Ne()))}),N=A(t,".whatsapp.audit.added",o=>{o.audit_event&&(pe(l=>[o.audit_event,...l]),E.current=Math.max(E.current,o.audit_event.id))});return()=>{a(),s(),i(),x(),N()}},[u?.id,n?.id,A,d,C,Pe,tt,Ne]),r.useEffect(()=>{if(V||!u?.id||!n?.id){Ge&&(clearInterval(Ge),Je(null));return}const t=async()=>{try{const s=await S.get(route("app.whatsapp.inbox.conversation.stream",{conversation:n.id}),{params:{after_message_id:D.current,after_note_id:w.current,after_audit_id:E.current}}),i=K(s.data?.new_messages),x=K(s.data?.updated_messages),N=K(s.data?.new_notes),o=K(s.data?.new_audit_events);i.length>0&&(R(l=>{const g=new Set(l.map(v=>v.id)),k=i.filter(v=>!g.has(v.id));return[...l,...k].sort((v,Vt)=>new Date(v.created_at).getTime()-new Date(Vt.created_at).getTime())}),D.current=Math.max(...i.map(l=>l.id),D.current)),x.length>0&&R(l=>l.map(g=>{const k=x.find(v=>v.id===g.id);return k?{...g,...k}:g})),N.length>0&&(Y(l=>[...N.slice().reverse(),...l]),w.current=Math.max(...N.map(l=>l.id),w.current)),o.length>0&&(pe(l=>[...o.slice().reverse(),...l]),E.current=Math.max(...o.map(l=>l.id),E.current)),s.data.conversation&&W(l=>({...l,...s.data.conversation}))}catch(s){console.error("[Conversation] Polling error:",s)}},a=setInterval(t,15e3);return Je(a),t(),()=>{clearInterval(a)}},[V,u?.id,u?.slug,n?.id]);const ke=r.useCallback(async()=>{if(ee)return;const t=O.message.trim();if(y.length>0){await rt(t||void 0),we("message");return}t&&Qe(route("app.whatsapp.conversations.send",{conversation:n.id}),{onSuccess:()=>{we("message"),d({title:"Message sent",variant:"success",duration:2e3})},onError:a=>{const s=Array.isArray(a?.message)?a.message[0]:a?.message,i=Array.isArray(a?.message_detail)?a.message_detail[0]:a?.message_detail,x=s==="outside_24h"||typeof s=="string"&&(s.includes("template")||s.includes("24 hour")||s.includes("recovery"));d({title:x?"Use a template to start the conversation":"Failed to send message",description:i||s||(x?"Send a template message using the template button above.":"Please try again"),variant:"error",duration:8e3}),x&&setTimeout(()=>{document.querySelector("[data-template-section]")?.scrollIntoView({behavior:"smooth",block:"nearest"})},300)}})},[ee,O.message,y.length,rt,Qe,u.slug,n.id,we,d]),zt=async()=>{const t=Oe.trim();if(t)try{const a=await S.post(route("app.whatsapp.conversations.notes.store",{conversation:n.id}),{note:t});a.data?.note&&(Y(s=>[a.data.note,...s]),w.current=Math.max(w.current,a.data.note.id)),qe(""),d({title:"Note added",variant:"success"})}catch(a){d({title:"Failed to add note",description:a?.response?.data?.message||"Please try again",variant:"error"})}},_e=r.useCallback(t=>{M||(Ke(!0),Gt.post(route("app.whatsapp.conversations.update",{conversation:n.id}),t,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{W(a=>({...a,...t})),d({title:"Conversation updated",variant:"success",duration:2e3})},onError:a=>{d({title:"Update failed",description:a?.assigned_to||a?.status||a?.priority||"Please try again.",variant:"error"})},onFinish:()=>{Ke(!1)}}))},[d,n.id,M]),Ot=t=>{t.preventDefault(),ke()};r.useEffect(()=>{const t=a=>{a.key==="Escape"&&$&&G(!1),(a.metaKey||a.ctrlKey)&&a.key==="Enter"&&(a.preventDefault(),ke()),(a.metaKey||a.ctrlKey)&&a.shiftKey&&(a.key.toLowerCase()==="e"&&(a.preventDefault(),Ue(s=>!s)),a.key.toLowerCase()==="k"&&(a.preventDefault(),se(s=>!s)),a.key.toLowerCase()==="t"&&(a.preventDefault(),re(s=>!s)))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[$,ke]);const qt=t=>{if(t.direction==="inbound")return null;switch(t.status){case"sent":return e.jsx(da,{className:"h-3.5 w-3.5 text-gray-400"});case"delivered":return e.jsx(ct,{className:"h-3.5 w-3.5 text-gray-400"});case"read":return e.jsx(ct,{className:"h-3.5 w-3.5 text-blue-500"});case"failed":return e.jsx("span",{className:"text-xs text-red-500 font-medium",children:"Failed"});default:return e.jsx(la,{className:"h-3.5 w-3.5 text-gray-400"})}},Kt=t=>{const a=t.payload||{};if(t.type==="image"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:a.link,alt:"Image attachment",className:"max-h-48 rounded-lg border border-gray-200 object-cover"}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="video"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsx("video",{controls:!0,className:"max-h-48 rounded-lg border border-gray-200 w-full",children:e.jsx("source",{src:a.link})}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="document"&&a.link)return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:a.link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-sm font-semibold text-emerald-700 hover:text-emerald-800",children:[e.jsx(ot,{className:"h-4 w-4"}),a.filename||"Document"]}),t.text_body&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.text_body})]});if(t.type==="location"&&a.latitude&&a.longitude){const s=`https://maps.google.com/?q=${a.latitude},${a.longitude}`;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:s,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-sm font-semibold text-emerald-700 hover:text-emerald-800",children:[e.jsx(dt,{className:"h-4 w-4"}),"View location"]}),a.name&&e.jsx("p",{className:"text-sm text-gray-700",children:a.name}),a.address&&e.jsx("p",{className:"text-xs text-gray-500",children:a.address})]})}return t.text_body?e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:t.text_body}):null};return e.jsxs(xt,{children:[e.jsx(it,{title:`${n.contact.name||n.contact.wa_id} - Inbox`}),e.jsxs("div",{className:"flex flex-col h-[calc(100vh-8rem)] lg:h-[calc(100vh-6rem)] rounded-3xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-[#075E54] text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsxs(Ce,{href:route("app.whatsapp.conversations.index",{}),className:"inline-flex items-center text-sm font-medium text-white/90 hover:text-white transition-colors","aria-label":"Back to conversations",children:[e.jsx(Jt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-[#25D366] flex items-center justify-center text-white font-bold text-lg shadow-lg flex-shrink-0",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:n.contact.name||n.contact.wa_id}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/80",children:[e.jsx(Qt,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:n.contact.wa_id}),e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsx("span",{className:"truncate",children:n.connection.name}),!V&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Zt,{className:"h-3 w-3 text-amber-200"}),"Polling"]})]}),V&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Xt,{className:"h-3 w-3 text-green-200"}),"Live"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"hidden sm:inline-flex rounded-full bg-white/15 px-3 py-1 text-xs uppercase tracking-wide",children:n.status}),e.jsx("button",{onClick:()=>G(!$),className:"lg:hidden p-2 rounded-lg text-white/90 hover:bg-white/10 transition-colors","aria-label":"Toggle menu",children:$?e.jsx(ae,{className:"h-5 w-5"}):e.jsx(Yt,{className:"h-5 w-5"})})]})]}),$&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden",onClick:()=>G(!1),"aria-hidden":"true"}),e.jsxs("div",{className:"fixed right-0 top-0 h-full w-80 bg-white dark:bg-gray-900 shadow-2xl z-50 lg:hidden p-6 border-l border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:"Conversation Info"}),e.jsx("button",{onClick:()=>G(!1),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Close conversation info",children:e.jsx(ae,{className:"h-5 w-5","aria-hidden":!0})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-xl border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n.contact.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.contact.wa_id})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Connection"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:n.connection.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Status"}),e.jsx(gt,{variant:n.status==="open"?"success":"default",className:"px-3 py-1",children:n.status})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[e.jsxs("div",{ref:ye,className:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden px-4 py-6 space-y-4 bg-[#efeae2] dark:bg-gray-950 focus:outline-none",style:{backgroundImage:"radial-gradient(rgba(0,0,0,0.04) 1px, transparent 1px)",backgroundSize:"16px 16px"},tabIndex:0,children:[jt?e.jsx(e.Fragment,{children:[...Array(3)].map((t,a)=>e.jsx(ca,{},a))}):P.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-white/80 dark:bg-gray-900 mb-4 shadow-sm",children:e.jsx(lt,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium mb-1",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Start the conversation!"})]}):P.map((t,a)=>{const s=a===0||new Date(t.created_at).toDateString()!==new Date(P[a-1].created_at).toDateString();return e.jsxs("div",{children:[s&&e.jsx("div",{className:"flex items-center justify-center my-4",children:e.jsx("div",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),e.jsx("div",{className:q("flex",t.direction==="outbound"?"justify-end":"justify-start"),children:e.jsxs("div",{className:q("max-w-xs lg:max-w-md px-4 py-2.5 rounded-2xl shadow-sm",t.direction==="outbound"?"bg-[#d9fdd3] text-gray-900 rounded-tr-md":"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-tl-md"),children:[Kt(t),e.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-2",children:[e.jsx("span",{className:q("text-[11px]",t.direction==="outbound"?"text-gray-600":"text-gray-500 dark:text-gray-400"),children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),qt(t)]})]})})]},t.id)}),e.jsx("div",{ref:Ve})]}),e.jsxs("aside",{className:"hidden lg:flex lg:w-80 xl:w-96 flex-col border-l border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg",children:n.contact.name?.charAt(0).toUpperCase()||n.contact.wa_id.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n.contact.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.contact.wa_id})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Connection"}),e.jsx("span",{className:"font-medium",children:n.connection.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx(gt,{variant:n.status==="open"?"success":"default",className:"px-3 py-1",children:n.status})]})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Assignment & Priority"}),M&&e.jsx("span",{className:"text-xs text-gray-400",children:"Savingâ€¦"})]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Assignee"}),e.jsxs("select",{value:n.assigned_to??"",onChange:t=>{const a=t.target.value?Number(t.target.value):null;_e({assigned_to:a})},disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"",children:"Unassigned"}),Ie.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.role,")"]},t.id))]}),n.assigned_to&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Assigned to ",Mt.get(n.assigned_to)?.name||"Unknown"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Priority"}),e.jsxs("select",{value:n.priority??"",onChange:t=>{const a=t.target.value||null;_e({priority:a})},disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"",children:"Not set"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Status"}),e.jsxs("select",{value:n.status,onChange:t=>_e({status:t.target.value}),disabled:M,className:"mt-1 block w-full rounded-xl border-gray-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-3 text-xs text-gray-600 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Auto-assign"}),e.jsx("div",{className:"mt-1",children:Be?.auto_assign_enabled?`Enabled (${Be.auto_assign_strategy.replace("_"," ")})`:"Disabled"}),e.jsx(Ce,{href:route("app.settings",{}),className:"mt-2 inline-flex text-xs font-semibold text-blue-600 hover:text-blue-700 dark:text-blue-400",children:"Manage inbox settings"})]})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Internal Notes"}),e.jsx("span",{className:"text-xs text-gray-500",children:ue.length})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(mt,{value:Oe,onChange:t=>qe(t.target.value),placeholder:"Add a private note...",className:"min-h-[80px] rounded-xl"}),e.jsx(h,{type:"button",onClick:zt,className:"w-full bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Add Note"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[ue.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No notes yet."}),ue.map(t=>e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 p-3",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-200 whitespace-pre-wrap",children:t.note}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 dark:text-gray-400",children:[t.created_by?.name||"System"," â€¢ ",new Date(t.created_at).toLocaleString()]})]},t.id))]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Audit Events"}),e.jsx("span",{className:"text-xs text-gray-500",children:he.length})]}),e.jsxs("div",{className:"space-y-3",children:[he.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No audit events yet."}),he.map(t=>e.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-3",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500",children:t.event_type.replaceAll("_"," ")}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-200",children:t.description}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500 dark:text-gray-400",children:[t.actor?.name||"System"," â€¢ ",new Date(t.created_at).toLocaleString()]})]},t.id))]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-200 dark:border-gray-800 bg-[#f0f2f5] dark:bg-gray-900 p-3 sticky bottom-0",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>Ue(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ea,{className:"h-3.5 w-3.5"}),"Emoji"]}),e.jsxs("button",{type:"button",onClick:()=>be.current?.click(),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ta,{className:"h-3.5 w-3.5"}),"Attach"]}),e.jsxs("button",{type:"button",onClick:()=>be.current?.click(),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(aa,{className:"h-3.5 w-3.5"}),"Photo/Video"]}),e.jsxs("button",{type:"button",onClick:()=>ie(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(dt,{className:"h-3.5 w-3.5"}),"Location"]}),e.jsxs("button",{type:"button","data-template-section":!0,onClick:()=>re(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300","aria-label":"Send template message",children:[e.jsx(ot,{className:"h-3.5 w-3.5"}),"Templates"]}),e.jsxs("button",{type:"button",onClick:()=>{ne(t=>!t),J(!1)},className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(sa,{className:"h-3.5 w-3.5"}),"Lists"]}),e.jsxs("button",{type:"button",onClick:()=>{J(t=>!t),ne(!1)},className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(ra,{className:"h-3.5 w-3.5"}),"Buttons"]}),e.jsxs("button",{type:"button",onClick:()=>se(t=>!t),className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1.5 text-xs font-semibold text-gray-600 shadow-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx(na,{className:"h-3.5 w-3.5"}),"Quick Replies"]}),e.jsx("input",{ref:be,type:"file",multiple:!0,accept:"image/*,video/*,application/pdf",className:"hidden",onChange:Bt})]}),wt&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-3 z-20 flex flex-wrap items-center gap-2 rounded-2xl border border-gray-200 bg-white/95 p-3 text-lg shadow-lg dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("div",{className:"w-full",children:e.jsx(p,{value:ge,onChange:t=>At(t.target.value),placeholder:"Search emojis",className:"rounded-xl text-sm"})}),He.length>0&&e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"mb-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:"Recent"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:He.map(t=>e.jsx("button",{type:"button",onClick:()=>at(t),className:"rounded-lg px-2 py-1 hover:bg-gray-100 dark:hover:bg-gray-700",children:t},`recent-${t}`))})]}),(ge.trim()?Xe.filter(t=>t.includes(ge.trim())):Xe).map(t=>e.jsx("button",{type:"button",onClick:()=>at(t),className:"rounded-lg px-2 py-1 hover:bg-gray-100 dark:hover:bg-gray-700",children:t},t))]})]}),St&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsx(p,{value:z.label,onChange:t=>X(a=>({...a,label:t.target.value})),placeholder:"Label (optional)",className:"rounded-xl"}),e.jsx(p,{value:z.lat,onChange:t=>X(a=>({...a,lat:t.target.value})),placeholder:"Latitude",className:"rounded-xl"}),e.jsx(p,{value:z.lng,onChange:t=>X(a=>({...a,lng:t.target.value})),placeholder:"Longitude",className:"rounded-xl"})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:()=>ie(!1),children:"Cancel"}),e.jsx(h,{type:"button",onClick:Ut,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Location"})]})]}),Nt&&e.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:e.jsx("div",{className:"grid gap-2",children:Tt.map(t=>e.jsxs("button",{type:"button",onClick:()=>{Et(t.text),se(!1)},className:"w-full rounded-xl border border-gray-200 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-700",children:[e.jsx("p",{className:"font-semibold",children:t.label}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.text})]},t.id))})}),kt&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800","data-template-section":!0,children:[e.jsxs("div",{className:"grid gap-3",children:[Ye.length===0&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No approved templates found for this connection."}),Ye.map(t=>e.jsxs("button",{type:"button",onClick:()=>{me(t),T(Array.from({length:t.variable_count||0},()=>""))},className:q("w-full rounded-xl border px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700",c?.id===t.id?"border-emerald-400 bg-emerald-50/70 text-emerald-900 dark:border-emerald-500/70 dark:bg-emerald-500/10 dark:text-emerald-100":"border-gray-200 text-gray-700 dark:border-gray-700 dark:text-gray-200"),children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.body_text||"Template message"})]},t.id))]}),c&&e.jsxs("div",{className:"mt-4 rounded-xl border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("div",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-200",children:"Fill template variables"}),f.length===0&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This template has no variables."}),e.jsxs("div",{className:"grid gap-4",children:[c.header_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Header variables"}),f.slice(0,c.header_count).map((t,a)=>e.jsx(p,{value:t,onChange:s=>{const i=[...f];i[a]=s.target.value,T(i)},placeholder:`Header variable ${a+1}`,className:"rounded-xl"},`${c.id}-header-${a}`))]}),c.body_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Body variables"}),f.slice(c.header_count,c.header_count+c.body_count).map((t,a)=>e.jsx(p,{value:t,onChange:s=>{const i=[...f];i[c.header_count+a]=s.target.value,T(i)},placeholder:`Body variable ${a+1}`,className:"rounded-xl"},`${c.id}-body-${a}`))]}),c.button_count>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Button variables"}),f.slice(c.header_count+c.body_count,c.variable_count).map((t,a)=>e.jsx(p,{value:t,onChange:s=>{const i=[...f];i[c.header_count+c.body_count+a]=s.target.value,T(i)},placeholder:`Button variable ${a+1}`,className:"rounded-xl"},`${c.id}-button-${a}`))]})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:()=>{me(null),T([])},children:"Clear"}),e.jsx(h,{type:"button",onClick:Ht,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Template"})]})]})]}),_t&&e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsxs("div",{className:"grid gap-3",children:[Fe.length===0&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["No lists available."," ",e.jsx(Ce,{href:route("app.whatsapp.lists.index"),className:"font-medium text-emerald-600 hover:text-emerald-500 dark:text-emerald-400 dark:hover:text-emerald-300",children:"Create lists in the Lists section"}),"."]}),Fe.map(t=>e.jsxs("button",{type:"button",onClick:()=>le(t),className:q("w-full rounded-xl border px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700",L?.id===t.id?"border-emerald-400 bg-emerald-50/70 text-emerald-900 dark:border-emerald-500/70 dark:bg-emerald-500/10 dark:text-emerald-100":"border-gray-200 text-gray-700 dark:border-gray-700 dark:text-gray-200"),children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.description||t.button_text})]},t.id))]}),L&&e.jsxs("div",{className:"mt-4 rounded-xl border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[e.jsxs("div",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-200",children:["Selected List: ",L.name]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:()=>{le(null)},children:"Clear"}),e.jsx(h,{type:"button",onClick:Ft,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send List"})]})]})]}),Ct&&e.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Body Text * (Max 1024 chars)"}),e.jsx(mt,{value:H,onChange:t=>de(t.target.value),placeholder:"Enter message body text",maxLength:1024,rows:3,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[H.length,"/1024 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Header Text (Optional, Max 60 chars)"}),e.jsx(p,{value:Q,onChange:t=>oe(t.target.value),placeholder:"Optional header text",maxLength:60,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Q.length,"/60 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Footer Text (Optional, Max 60 chars)"}),e.jsx(p,{value:Z,onChange:t=>ce(t.target.value),placeholder:"Optional footer text",maxLength:60,className:"rounded-xl"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Z.length,"/60 characters"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Buttons (Max 3)"}),b.length<3&&e.jsxs(h,{type:"button",onClick:Rt,variant:"secondary",size:"sm",children:[e.jsx(ia,{className:"h-3 w-3 mr-1"}),"Add Button"]})]}),e.jsx("div",{className:"space-y-2",children:b.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-2 border border-gray-200 dark:border-gray-700 rounded-lg p-2",children:[e.jsx(p,{value:t.id,onChange:s=>st(a,"id",s.target.value),placeholder:"Button ID (unique)",maxLength:256,className:"flex-1 text-sm rounded-lg"}),e.jsx(p,{value:t.text,onChange:s=>st(a,"text",s.target.value),placeholder:"Button text (max 20)",maxLength:20,className:"flex-1 text-sm rounded-lg"}),b.length>1&&e.jsx(h,{type:"button",onClick:()=>$t(a),variant:"ghost",size:"sm",children:e.jsx(ae,{className:"h-3 w-3 text-red-500"})})]},a))})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:()=>{J(!1),U([{id:"",text:""}]),de(""),oe(""),ce("")},children:"Cancel"}),e.jsx(h,{type:"button",onClick:Pt,className:"bg-[#25D366] hover:bg-[#1DAA57] text-white",children:"Send Buttons"})]})]})}),y.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((t,a)=>e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white px-3 py-1 text-xs text-gray-600 shadow-sm dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("span",{className:"truncate max-w-[160px]",children:t.name}),e.jsx("button",{type:"button",onClick:()=>It(a),className:"text-gray-400 hover:text-gray-600","aria-label":`Remove ${t.name}`,children:e.jsx(ae,{className:"h-3.5 w-3.5","aria-hidden":!0})})]},`${t.name}-${a}`))}),e.jsxs("form",{onSubmit:Ot,className:"flex items-center gap-3",children:[e.jsx(p,{value:O.message,onChange:t=>je("message",t.target.value),placeholder:"Type a message",className:"flex-1 rounded-full bg-white dark:bg-gray-800",disabled:ee,autoFocus:!0,"aria-label":"Message input"}),e.jsx(h,{type:"submit",disabled:ee||!O.message.trim()&&y.length===0,"aria-label":"Send message",className:"bg-[#25D366] hover:bg-[#1DAA57] text-white rounded-full px-5",children:e.jsx(lt,{className:"h-4 w-4"})})]})]}),Ze.message&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2",role:"alert",children:Ze.message})]})]})]})}export{Aa as default};
